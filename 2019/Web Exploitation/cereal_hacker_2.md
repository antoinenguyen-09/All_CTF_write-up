
# CEREAL-HACKER-2
### Thể loại: Web Exploitation.
### Thử thách: 
Đây là part 2 của cereal hacker 1. Nhưng mục tiêu của chúng ta lần này không phải là đăng nhập với tư cách admin nữa mà phải lấy được mật khẩu của thằng admin:))

https://2019shell1.picoctf.com/problem/62195/
### Gợi ý: không có
### Kiến thức nền:
 - Local file inclusion.
 - SQL injection.
 - Remote Access to MySQL Server.
### Giải quyết vấn đề:
1/ Initial reconnaissance:

Nhìn giao diện của trang web này không khác gì của cái trang đầu. Vậy thì hãy cùng đi sâu vào bên trong để xem nó có khác biệt gì không nào. Lặp lại bước mấu chốt để tìm ra flag trong bài cereal hacker 1 (chi tiết xem các phần 3 của write-up [cereal hacker 1](https://github.com/antoinenguyen-09/picoCTF_write-up/blob/master/2019/Web%20Exploitation/cereal_hacker_1.md),) chúng ta thu được kết quả như sau:

![image](https://user-images.githubusercontent.com/61876488/92147452-5f76d980-ee45-11ea-9cc0-19b725ade716.png)

Đúng như mình dự đoán, lần này khi gửi request lên server thì thằng browser không để lộ HTTP Cookie ra nữa. Giở lại cái list kiến thức nền của write-up [cereal hacker 1](https://github.com/antoinenguyen-09/picoCTF_write-up/blob/master/2019/Web%20Exploitation/cereal_hacker_1.md) :

![image](https://user-images.githubusercontent.com/61876488/92149057-a796fb80-ee47-11ea-8be5-8860e876e493.png)

Theo như những gì mình test nãy giờ thì ba lỗ hổng phía dưới đã được trang web này fix lại rồi. Chỉ còn duy nhất cái phía trên: Local File Inclusion. "Hiện tượng lạ" mà mình mắt thấy chứ hông có nằm chiêm bao này càng khẳng định khả năng trên 99.9% sẽ xảy ra:

![image](https://user-images.githubusercontent.com/61876488/92150380-88996900-ee49-11ea-8e2d-8ec14ba98074.png)

Cùng một thay đổi nhỏ trên URL của 2 trang web này "`file=antoine`" nhưng lại trả về 2 kết quả khác nhau. Từ đây có thể suy ra vài điều:
- Query parameter "file" trên thanh URL của trang web lần này có vẻ như luôn luôn trỏ tới một trang chứa code php của server. (vì gán cái vẹo gì cho parameter "file" nó cũng hiện ra là Unable to locate [cái gì đó].php). 
- Dòng "Unable to locate ....php" hiện ra trên page là 1 message PHP 404 Not Found được trả về từ server. 
Như vậy mục tiêu chúng ta nhắm tới tiếp theo đây chính là parameter "file" trên URL.
2/ Local File Inclusion:
Trước tiên, chúng ta thử một vài traversal đơn giản trước. 
